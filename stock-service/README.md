# Stock Index Advisor - FastAPI Backend

## ğŸš€ Quick Start

### Option 1: Start Both Services (Recommended)
```bash
./start_app.sh
```

This will start both the FastAPI server and Next.js frontend simultaneously.

### Option 2: Start Services Separately

#### Start FastAPI Server
```bash
cd stock-service
poetry run uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
```

#### Alternative: Using Poetry Shell
```bash
cd stock-service
poetry shell
uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
```

#### Start Next.js Frontend
```bash
cd frontend
npm run dev
```

## ğŸ“¡ API Endpoints

### Base URL: `http://localhost:8000`

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/` | GET | Root endpoint - API status |
| `/health` | GET | Health check |
| `/docs` | GET | Interactive API documentation |
| `/api/index-fields` | GET | Get all available index fields |
| `/api/create-index` | POST | Create custom stock index |

## ğŸ”§ API Documentation

Once the server is running, visit:
- **Interactive Docs**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ“Š Index Creation Request Format

```json
{
  "indexSize": 100,
  "indexCurrency": "EUR",
  "indexStartDate": "2024-01-01",
  "indexEndDate": "2024-12-31",
  "selectedCountries": ["US", "CN"],
  "selectedSectors": ["Technology"],
  "selectedIndustries": ["Software - Application"],
  "selectedKPIs": {
    "price_to_earnings_ratio_perc": ["60", "70", "80"]
  },
  "selectedStocks": ["AAPL", "GOOGL"]
}
```

## ğŸ—ï¸ Architecture

- **FastAPI**: Modern, fast web framework for building APIs
- **Pydantic**: Data validation using Python type annotations
- **CORS**: Configured to allow frontend requests
- **Uvicorn**: ASGI server for running FastAPI
- **CSV Files**: Index fields are read from CSV files generated by `field_maker.py`

## ğŸ“ Data Flow

1. **field_maker.py** â†’ Generates CSV files from database
2. **csv_reader.py** â†’ Reads CSV files for API responses
3. **main.py** â†’ FastAPI server serving the data
4. **Frontend** â†’ Consumes API endpoints

## ğŸ”„ Migration from Next.js API Routes

The application has been migrated from Next.js API routes to FastAPI for:
- âœ… Better performance
- âœ… Automatic API documentation
- âœ… Type safety with Pydantic
- âœ… No temporary files
- âœ… Standard REST API architecture
